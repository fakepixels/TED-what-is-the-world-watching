<!DOCTYPE html>
<html>
<head>
<meta name="authors" content="Vaidehi Garg (vg254) and Tina He (mh2235)">
<title>INFO 3300: Project 1</title>
<link href="https://fonts.googleapis.com/css?family=Playfair+Display" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Karma" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Krona+One" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Bowlby+One+SC" rel="stylesheet">
<script src="https://d3js.org/d3.v3.min.js"></script>
<script src="https://d3js.org/d3.v4.min.js"></script>
<script src="http://d3js.org/topojson.v2.min.js"></script>
<script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>
<style>
  h1 { font-size: 220px; color: #E62B1E; margin: -10px;}
  h2 { font-size: 20px; font-family: 'Krona One', sans-serif, serif}
  p { font-family: 'PT Sans', sans-serif; max-width: 35%; align-content: center;}
  .arc text { font: 10px "Krona One", sans-serif; text-anchor: middle;}
  #title { padding: -20px;}
  #introduction { margin: -20px; padding: 80px; background-color: #F5F5F5;}
  #cloudSection { margin: -20px; padding: 80px; background-color: #E62B1E;}
  #ratingSection { margin: -20px; padding: 80px; background-color: #ECECEC;}
  #durationSection { margin: -20px; padding: 80px; background-color: #F3F3F3;}
  #end { margin: -20px; padding: 250px; position: relative;}
  #ending-bkgd { font-family: 'Krona One', sans-serif; font-size: 110px; opacity: 0.05; position: absolute; top: 15; left: 0; bottom: 30; right: 0; z-index: -20; overflow: hidden;}
</style>
</head>

<body>

<!-- HEADER -->
<section id="introduction">
    <div id="header" align="center">
        <p>INFO 3300: Project 1 <br>Vaidehi Garg (vg254) and Tina He (mh2235)</p>
    </div>  
    <div id="title" align="center" style="font-family: 'Krona One', sans-serif, serif">
        <img src="ted_logo.png" alt="TED Logo" vspace="20">
        <h2> What Is The World Watching? </h2>
        <p> In the last decade, TED talks gave gained traction worldwide. In this project, we use data from TED talks to gain a better sense of what makes them click. The dataset, <a href="https://www.kaggle.com/rounakbanik/ted-data-analysis/data">available here</a>, contains details on 2550 TED talks, from which we intend to extract some key insights.</p>
    </div>
</section>
<!-- END HEADER -->

<!-- VISUALIZATION 1: TAG WORD CLOUD -->
<section id="cloudSection" align="center">
<div id="cloud" align="center">

<script>

d3.select("#cloud").append("svg")
.attr("id", "tagSVG")
.attr("width", 1000)
.attr("height", 400);

var tagSVG = d3.select("#tagSVG");

var tagData;

d3.queue()
.defer(d3.json, "tags.json")
.await(callback);

/* Returns random integer between min and max (both inclusive) */
function randInt(min, max) {
  return Math.floor(Math.random() * (max - min + 1)) + min;
}

function callback(error, data) {
  tagData = data;

  var count = 0;

  /* X and Y values generated using random number generator function, hard-coded for aesthetic purposes */
  var x_vals = [333, 370, 615, 296, 250, 735, 760, 590, 200, 230, 535, 750, 505, 314, 622, 605, 667, 180, 500, 405, 425, 382, 490, 450, 580];
  var y_vals = [452, 250, 400, 273, 350, 243, 396, 460, 400, 426, 375, 340, 316, 215, 260, 495, 434, 310, 400, 327, 489, 415, 340, 450, 230];

  tagData.forEach(function (d, i) {
    var num = d.count;

    /* We are only considering the top 25 tags, i.e. words with count > 150 */
    if (num > 150) {
      tagSVG.append("text")
      .text(d.tag)
      .style("font-size", num/10)
      .attr("font-family",'Bowlby One SC, cursive')
      .style("fill", "#FFFFFF")
      .style("text-anchor", "middle")
      .transition().delay(count*100)
      .style("opacity", 1-(num/1200))
      .attr("x", x_vals[count])
      .attr("y", y_vals[count]-150);
      count++;
    }
  });
}

</script>
    <h2 style="color:white"> What Are TED Talks About? </h2>
    <p style="color:white"> We were curious about the topics that are popularly addressed in TED talks. Here, we have created a word cloud of the 25 most popular tags amongst TED talks. Each of the tags above has at least 150 talks associated with it!</p>
</div>
</section>
<!-- END VISUALIZATION 1 -->

<!-- VISUALIZATION 2: RATINGS BAR GRAPH -->
<section id="ratingSection">
<div id="ratings" align="center">

<script>

d3.select("#ratings").append("svg")
.attr("id", "ratingSVG")
.attr("width", 1000)
.attr("height", 550);

var ratingSVG = d3.select("#ratingSVG");

var ratingData;

d3.queue()
.defer(d3.json, "ratings.json")
.await(callback);

function callback(error, data) {
  ratingData = data;

  var countScale = d3.scaleLog()
  .base(10)
  .domain([50000,2000000])
  .range([400,25])

  var indexScale = d3.scaleLinear()
  .domain([-1,14])
  .range([150,950])

  var countAxis = d3.axisLeft(countScale)
  .tickFormat(d3.format(",.0f"))
  .ticks(10);

  var reaction_labels = ["Funny", "Beautiful", "Ingenious", "Courageous", 
  "Longwinded", "Confusing", "Informative", "Fascinating", "Unconvincing", 
  "Persuasive", "Jaw-dropping", "OK", "Obnoxious", "Inspiring"];

  var indexAxis = d3.axisBottom(indexScale)
  .ticks(14)
  .tickFormat(function(d, i){
    if (i > 0 && i < 15) return reaction_labels[d];
  });

  ratingSVG.append("g")
  .call(countAxis)
  .attr("transform", "translate(150, 0)")
  .attr("font-size",12)
  .attr("font-family",'Krona One, sans-serif')

  ratingSVG.append("g")
  .call(indexAxis)
  .attr("transform", "translate(0, 400)")
  .attr("font-size",12)
  .attr("font-family",'Krona One, sans-serif')
  .selectAll("text")  
        .style("text-anchor", "end")
        .attr("dx", "-.8em")
        .attr("dy", ".15em")
        .attr("transform", "rotate(-65)");

  ratingData.forEach(function (d, i) {
    ratingSVG.append("line")
    .attr("x1", indexScale(i))
    .attr("y1", 400)
    .attr("x2", indexScale(i))
    .attr("y2", countScale(d.count))
    .style("stroke-width", 28)
    .style("stroke", "red");

    if (d.rating != "Jaw-dropping" ) {
      ratingSVG.append("svg:image")
      .attr('x', indexScale(i)-12.5)
      .attr('y', countScale(d.count)-25)
      .attr('width', 25)
      .attr('height', 25)
      .attr("xlink:href", "emoji/" + d.rating + ".svg");
    }
    else {
      ratingSVG.append("svg:image")
      .attr('x', indexScale(i)-20)
      .attr('y', countScale(d.count)-40)
      .attr('width', 40)
      .attr('height', 40)
      .attr("xlink:href", "emoji/" + d.rating + ".svg");
    }
  });

  ratingSVG.append("text")
      .text("Audience Reaction")
      .style("text-anchor", "middle")
      .attr("transform", "translate (500,540)")
      .attr("font-size",14)
      .attr("font-family",'Krona One, sans-serif');

  ratingSVG.append("text")
      .text("Count")
      .style("text-anchor", "middle")
      .attr("x", "3%")
      .attr("y", "50%")
      .attr("transform", "rotate (270, 0, 230)")
      .attr("font-size",14)
      .attr("font-family",'Krona One, sans-serif');

}

</script>
    <h2 style="color:#2B2B2B"> What Reactions Do They Evoke? </h2>
    <p style="color:#2B2B2B"> How do people respond to TED talks?</p>
    <p style="color:#2B2B2B">TED allows online viewers to "rate" the talks based on the reaction they evoke in them. Some of the most popular responses to TED talks are: "Inspiring", "Informative", "Fascinating", and "Persuasive".</p>
</div>
</section>
<!-- END VISUALIZATION 2 -->

<!-- VISUALIZATION 3: DURATION HISTOGRAM -->
<section id="durationSection">
<div id="durations" align="center"></div>

<script>

var width = 500,
    height = 500,
    radius = Math.min(width, height) / 2;

var opacity = d3.scaleLinear()
.domain([50,1250])
.range([0.1,0.9]);

var arc = d3.svg.arc()
    .outerRadius(radius - 10)
    .innerRadius(radius - 70);

var pie = d3.layout.pie()
    .sort(null)
    .value(function(d) { return d.count; });

var durationSVG = d3.select("#durations").append("svg")
    .attr("width", width)
    .attr("height", height)
    .append("g")
    .attr("transform", "translate(" + width / 2 + "," + height / 2 + ")");

d3.csv("durations.csv", type, function(error, data) {
  if (error) throw error;

  var chart = durationSVG.selectAll(".arc")
      .data(pie(data))
      .enter().append("g")
      .attr("class", "arc");

  chart.append("path")
      .attr("d", arc)
      .style("fill", "red")
      .style("opacity", function(d) { return opacity(d.data.count); });

  chart.append("text")
      .attr("transform", function(d) { return "translate(" + arc.centroid(d) + ")"; })
      .attr("dy", ".35em")
      .text(function(d) { return d.data.bin; });

});

function type(d) {
  d.count = +d.count;
  return d;
}

</script>
    <h2 style="color:#2B2B2B" align="center"> How Long Is Too Long? </h2>
    <p style="color:#2B2B2B" align="center">Add text here. For some reason I am not able to center this >:(</p>
</div>
</section>
<!-- END VISUALIZATION 3 -->

<section id="end" align="center">
<div id="ending-bkgd">What's next?</div>
<div id="ending" align="center">
    <h2>What's next?</h2>
    <p>In the future, we want to be able to analyze what are the elements that make an effective TED talk. The information can inform us about not just cultural trends, but also public speaking skills.</p>
</div>
</section>

</body>
</html>
